package io.github.confuser2188.exploitguard.misc;

import io.github.confuser2188.packetlistener.minecraft.ItemStack;
import io.github.confuser2188.packetlistener.minecraft.NBTTagCompound;
import io.github.confuser2188.packetlistener.minecraft.NBTTagList;

public class BookNBT {

    public static boolean checkInvalidNBT(ItemStack itemStack) throws Exception{
        if (itemStack.getItemStack() != null && itemStack.getItem().getItem() != null && itemStack.getItem().getName() != null) {
            String itemName = itemStack.getItem().getName();
            if (itemName.equals("book")
                    || itemName.equals("writingBook")
                    || itemName.equals("writtenBook")) {
                NBTTagCompound tagCompound = new NBTTagCompound(itemStack.getItemStack());
                if (tagCompound.isValid() && tagCompound.hasKey("pages")) {
                    NBTTagList list = tagCompound.getList("pages", 8);
                    if (list.size() > 50)
                        return true;
                    else if (list.size() >= 1)
                        for (int i = 0; i < list.size(); i++)
                            if (list.getString(i).length() > 257)
                                return true;
                }
            }
        }
        return false;
    }

}
