package io.github.confuser2188.exploitguard.module.check;

import io.github.confuser2188.exploitguard.module.Check;
import io.github.confuser2188.exploitguard.module.Module;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.player.AsyncPlayerPreLoginEvent;
import org.bukkit.event.player.PlayerKickEvent;

public class AlreadyIngame extends Module{

    public AlreadyIngame() {
        super(Check.ALREADY_INGAME);
    }

    @EventHandler
    public void onKick(PlayerKickEvent event){
        if(event.getReason().equals("You logged in from another location"))
            event.setCancelled(true);
    }

    @EventHandler
    public void onPreJoin(AsyncPlayerPreLoginEvent event){
        String name = event.getName();
        for(Player player : Bukkit.getOnlinePlayers())
            if(player.getName().equalsIgnoreCase(name))
                event.disallow(AsyncPlayerPreLoginEvent.Result.KICK_OTHER, "A player with the same name is already in game!");
    }
}
