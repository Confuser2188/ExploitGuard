package io.github.confuser2188.packetlistener_eg.minecraft;

import io.github.confuser2188.packetlistener_eg.Reflection;

import java.lang.reflect.Method;
import java.util.Set;

public class NBTTagCompound  {

    private Object tag;

    public NBTTagCompound(Object tag) throws Exception {
        Method getList = tag.getClass().getMethod("getTag");

        this.tag = getList.invoke(tag);
    }

    public NBTTagCompound(Object tag, byte b) {
        this.tag = tag;
    }

    public boolean hasKey(String str) throws Exception {
        Method method = tag.getClass().getMethod("hasKey", String.class);
        return (boolean) method.invoke(tag, str);
    }

    public NBTTagList getList(String str, int i) throws Exception {
        Method getList = tag.getClass().getMethod("getList", String.class, int.class);
        Object tagObj = getList.invoke(tag, str, i);

        return new NBTTagList(tagObj);
    }

    public Set<String> getKeys() throws Exception{
        Object map = Reflection.getFieldValue(tag, "map");

        Method method = map.getClass().getMethod("keySet");
        return (Set<String>) method.invoke(map);
    }

    public NBTBase get(String key) throws Exception{
        Method method = tag.getClass().getMethod("get", String.class);
        return new NBTBase(method.invoke(tag, key));
    }

    public boolean isValid()
    {
        return tag != null;
    }
}
